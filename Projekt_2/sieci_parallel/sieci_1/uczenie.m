%uczenie predyktora oe
clear all;
n=0; farx(n+1)=8.532576e+003; foe(n+1)=8.532570e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=6.890823e+003; foe(n+1)=6.890763e+003; krok(n+1)=2.494331e-004; ng(n+1)=2.835623e+003;
n=2; farx(n+1)=2.947318e+003; foe(n+1)=2.905514e+003; krok(n+1)=1.688698e-002; ng(n+1)=4.175087e+002;
n=3; farx(n+1)=3.059931e+003; foe(n+1)=2.631642e+003; krok(n+1)=9.833971e-005; ng(n+1)=4.928841e+003;
n=4; farx(n+1)=3.837039e+003; foe(n+1)=1.919253e+003; krok(n+1)=7.010405e-004; ng(n+1)=5.369014e+003;
n=5; farx(n+1)=3.684156e+003; foe(n+1)=1.881738e+003; krok(n+1)=3.096691e-003; ng(n+1)=2.928811e+003;
n=6; farx(n+1)=3.881584e+003; foe(n+1)=1.873616e+003; krok(n+1)=4.437686e-003; ng(n+1)=3.134156e+003;
n=7; farx(n+1)=1.943004e+003; foe(n+1)=1.138667e+003; krok(n+1)=1.814761e+000; ng(n+1)=3.059634e+003;
n=8; farx(n+1)=1.355325e+003; foe(n+1)=1.031699e+003; krok(n+1)=6.128735e-001; ng(n+1)=6.888430e+002;
n=9; farx(n+1)=1.599481e+003; foe(n+1)=9.674286e+002; krok(n+1)=2.425306e+000; ng(n+1)=4.351253e+002;
n=10; farx(n+1)=1.702267e+003; foe(n+1)=9.353057e+002; krok(n+1)=4.178411e-001; ng(n+1)=3.119556e+002;
n=11; farx(n+1)=1.627177e+003; foe(n+1)=9.204927e+002; krok(n+1)=1.119298e+000; ng(n+1)=2.354686e+002;
n=12; farx(n+1)=1.622095e+003; foe(n+1)=9.193064e+002; krok(n+1)=2.894475e-001; ng(n+1)=1.202077e+002;
n=13; farx(n+1)=1.546579e+003; foe(n+1)=9.177682e+002; krok(n+1)=1.420334e+000; ng(n+1)=1.186913e+002;
n=14; farx(n+1)=1.541262e+003; foe(n+1)=9.159616e+002; krok(n+1)=2.924078e+000; ng(n+1)=4.351830e+001;
n=15; farx(n+1)=1.257518e+003; foe(n+1)=9.040076e+002; krok(n+1)=1.916702e+001; ng(n+1)=7.396520e+001;
n=16; farx(n+1)=4.009250e+002; foe(n+1)=8.364326e+002; krok(n+1)=4.406235e-001; ng(n+1)=4.556736e+002;
n=17; farx(n+1)=3.926299e+002; foe(n+1)=8.363092e+002; krok(n+1)=9.677161e-005; ng(n+1)=3.074266e+003;
n=18; farx(n+1)=3.758150e+002; foe(n+1)=8.280293e+002; krok(n+1)=3.132059e-001; ng(n+1)=3.211315e+003;
n=19; farx(n+1)=2.585218e+002; foe(n+1)=7.547953e+002; krok(n+1)=1.272089e-001; ng(n+1)=2.893189e+003;
n=20; farx(n+1)=2.234195e+002; foe(n+1)=7.074961e+002; krok(n+1)=1.895930e-001; ng(n+1)=4.220477e+003;
n=21; farx(n+1)=1.831385e+002; foe(n+1)=6.499224e+002; krok(n+1)=1.407955e-001; ng(n+1)=3.737382e+003;
n=22; farx(n+1)=1.346244e+002; foe(n+1)=5.324663e+002; krok(n+1)=3.136529e-001; ng(n+1)=7.919056e+003;
n=23; farx(n+1)=9.971980e+001; foe(n+1)=4.690296e+002; krok(n+1)=4.210052e-001; ng(n+1)=5.147362e+003;
n=24; farx(n+1)=7.549409e+001; foe(n+1)=4.009798e+002; krok(n+1)=5.174513e-001; ng(n+1)=2.810073e+003;
n=25; farx(n+1)=7.482468e+001; foe(n+1)=3.744258e+002; krok(n+1)=5.836445e-003; ng(n+1)=4.291791e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=7.645933e+001; foe(n+1)=3.665701e+002; krok(n+1)=1.454766e-006; ng(n+1)=5.301660e+003;
n=27; farx(n+1)=6.545272e+001; foe(n+1)=3.533535e+002; krok(n+1)=1.864430e-005; ng(n+1)=1.883564e+003;
n=28; farx(n+1)=4.809015e+001; foe(n+1)=2.891800e+002; krok(n+1)=1.564230e-003; ng(n+1)=3.774673e+002;
n=29; farx(n+1)=4.675004e+001; foe(n+1)=2.867761e+002; krok(n+1)=8.489916e-005; ng(n+1)=5.872477e+003;
n=30; farx(n+1)=4.716036e+001; foe(n+1)=2.865372e+002; krok(n+1)=1.059505e-004; ng(n+1)=5.815986e+003;
n=31; farx(n+1)=4.765421e+001; foe(n+1)=2.862019e+002; krok(n+1)=7.839040e-004; ng(n+1)=5.257757e+003;
n=32; farx(n+1)=4.246112e+001; foe(n+1)=2.797922e+002; krok(n+1)=1.078150e-002; ng(n+1)=4.649599e+003;
n=33; farx(n+1)=2.938329e+001; foe(n+1)=2.470235e+002; krok(n+1)=1.154088e+000; ng(n+1)=5.915124e+003;
n=34; farx(n+1)=2.515437e+001; foe(n+1)=2.257185e+002; krok(n+1)=4.859246e-001; ng(n+1)=1.244618e+003;
n=35; farx(n+1)=2.405189e+001; foe(n+1)=2.184830e+002; krok(n+1)=2.367770e-001; ng(n+1)=6.170433e+003;
n=36; farx(n+1)=2.469089e+001; foe(n+1)=2.114775e+002; krok(n+1)=3.923690e-001; ng(n+1)=1.159199e+003;
n=37; farx(n+1)=2.101203e+001; foe(n+1)=2.034099e+002; krok(n+1)=9.512526e-001; ng(n+1)=2.027485e+003;
n=38; farx(n+1)=1.971258e+001; foe(n+1)=2.000047e+002; krok(n+1)=3.805404e-001; ng(n+1)=6.297639e+003;
n=39; farx(n+1)=1.781319e+001; foe(n+1)=1.963333e+002; krok(n+1)=3.465039e-001; ng(n+1)=2.133043e+003;
n=40; farx(n+1)=1.775199e+001; foe(n+1)=1.927223e+002; krok(n+1)=1.236406e+000; ng(n+1)=3.448488e+002;
n=41; farx(n+1)=1.823390e+001; foe(n+1)=1.913815e+002; krok(n+1)=8.457767e-001; ng(n+1)=4.016782e+003;
n=42; farx(n+1)=1.737292e+001; foe(n+1)=1.905518e+002; krok(n+1)=8.551844e-001; ng(n+1)=4.062246e+002;
n=43; farx(n+1)=1.686686e+001; foe(n+1)=1.901167e+002; krok(n+1)=7.734497e-001; ng(n+1)=1.020676e+003;
n=44; farx(n+1)=1.691729e+001; foe(n+1)=1.900067e+002; krok(n+1)=9.282331e-001; ng(n+1)=4.455888e+002;
n=45; farx(n+1)=1.694671e+001; foe(n+1)=1.899613e+002; krok(n+1)=8.008859e-001; ng(n+1)=5.761764e+002;
n=46; farx(n+1)=1.690348e+001; foe(n+1)=1.899560e+002; krok(n+1)=7.679697e-001; ng(n+1)=2.308410e+002;
n=47; farx(n+1)=1.685731e+001; foe(n+1)=1.899527e+002; krok(n+1)=1.215405e+000; ng(n+1)=5.807910e+001;
n=48; farx(n+1)=1.689003e+001; foe(n+1)=1.899451e+002; krok(n+1)=5.242640e+000; ng(n+1)=6.651016e+001;
n=49; farx(n+1)=1.686317e+001; foe(n+1)=1.899403e+002; krok(n+1)=1.296088e+000; ng(n+1)=8.597198e+001;
n=50; farx(n+1)=1.686225e+001; foe(n+1)=1.899383e+002; krok(n+1)=3.708110e+000; ng(n+1)=5.094085e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.686194e+001; foe(n+1)=1.899383e+002; krok(n+1)=2.825434e-007; ng(n+1)=1.728109e+001;
n=52; farx(n+1)=1.686890e+001; foe(n+1)=1.899381e+002; krok(n+1)=5.667521e-006; ng(n+1)=1.168939e+001;
n=53; farx(n+1)=1.689120e+001; foe(n+1)=1.899375e+002; krok(n+1)=1.695813e-005; ng(n+1)=1.368114e+001;
n=54; farx(n+1)=1.699945e+001; foe(n+1)=1.899281e+002; krok(n+1)=4.813050e-004; ng(n+1)=1.021756e+001;
n=55; farx(n+1)=1.701756e+001; foe(n+1)=1.899247e+002; krok(n+1)=1.970836e-003; ng(n+1)=3.106789e+000;
n=56; farx(n+1)=1.704858e+001; foe(n+1)=1.899194e+002; krok(n+1)=6.374691e-003; ng(n+1)=2.126997e+000;
n=57; farx(n+1)=1.706488e+001; foe(n+1)=1.899190e+002; krok(n+1)=1.725161e-002; ng(n+1)=1.065865e+000;
n=58; farx(n+1)=1.705336e+001; foe(n+1)=1.899189e+002; krok(n+1)=8.377756e-001; ng(n+1)=1.777397e+000;
n=59; farx(n+1)=1.705321e+001; foe(n+1)=1.899189e+002; krok(n+1)=9.576737e-001; ng(n+1)=2.568392e-001;
n=60; farx(n+1)=1.705321e+001; foe(n+1)=1.899189e+002; krok(n+1)=5.905503e-009; ng(n+1)=2.845797e-002;
n=61; farx(n+1)=1.705321e+001; foe(n+1)=1.899189e+002; krok(n+1)=7.074863e-010; ng(n+1)=2.845797e-002;
n=62; farx(n+1)=1.705321e+001; foe(n+1)=1.899189e+002; krok(n+1)=4.375303e-010; ng(n+1)=2.845797e-002;
n=63; farx(n+1)=1.705321e+001; foe(n+1)=1.899189e+002; krok(n+1)=6.833629e-011; ng(n+1)=2.845797e-002;
n=64; farx(n+1)=1.705321e+001; foe(n+1)=1.899189e+002; krok(n+1)=7.657770e-011; ng(n+1)=2.845797e-002;
n=65; farx(n+1)=1.705321e+001; foe(n+1)=1.899189e+002; krok(n+1)=1.881189e-008; ng(n+1)=2.845797e-002;
n=66; farx(n+1)=1.705321e+001; foe(n+1)=1.899189e+002; krok(n+1)=2.120055e-008; ng(n+1)=2.845796e-002;
 % z³y kierunek w metodzie zm - odnowa 
n=67; farx(n+1)=1.705321e+001; foe(n+1)=1.899189e+002; krok(n+1)=2.540390e-007; ng(n+1)=2.845796e-002;
n=68; farx(n+1)=1.705320e+001; foe(n+1)=1.899189e+002; krok(n+1)=2.664567e-006; ng(n+1)=1.425961e-002;
n=69; farx(n+1)=1.705320e+001; foe(n+1)=1.899189e+002; krok(n+1)=1.703646e-005; ng(n+1)=3.709254e-003;
n=70; farx(n+1)=1.705320e+001; foe(n+1)=1.899189e+002; krok(n+1)=1.511164e-005; ng(n+1)=1.480185e-003;
n=71; farx(n+1)=1.705320e+001; foe(n+1)=1.899189e+002; krok(n+1)=6.033380e-008; ng(n+1)=1.481468e-003;
n=72; farx(n+1)=1.705320e+001; foe(n+1)=1.899189e+002; krok(n+1)=1.643075e-012; ng(n+1)=1.481468e-003;
n=73; farx(n+1)=1.705320e+001; foe(n+1)=1.899189e+002; krok(n+1)=1.024995e-006; ng(n+1)=1.481467e-003;
n=74; farx(n+1)=1.705320e+001; foe(n+1)=1.899189e+002; krok(n+1)=1.440983e-005; ng(n+1)=1.478367e-003;
n=75; farx(n+1)=1.705320e+001; foe(n+1)=1.899189e+002; krok(n+1)=1.725533e-005; ng(n+1)=1.482803e-003;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.705320e+001; foe(n+1)=1.899189e+002; krok(n+1)=4.024172e-007; ng(n+1)=1.482774e-003;
n=77; farx(n+1)=1.705320e+001; foe(n+1)=1.899189e+002; krok(n+1)=6.432808e-006; ng(n+1)=1.860937e-003;
n=78; farx(n+1)=1.705320e+001; foe(n+1)=1.899189e+002; krok(n+1)=1.144049e-004; ng(n+1)=1.662982e-003;
n=79; farx(n+1)=1.705320e+001; foe(n+1)=1.899189e+002; krok(n+1)=1.208931e-004; ng(n+1)=2.041353e-003;
n=80; farx(n+1)=1.705320e+001; foe(n+1)=1.899189e+002; krok(n+1)=1.384035e-005; ng(n+1)=1.375401e-003;
n=81; farx(n+1)=1.705320e+001; foe(n+1)=1.899189e+002; krok(n+1)=4.171898e-007; ng(n+1)=1.375408e-003;
n=82; farx(n+1)=1.705320e+001; foe(n+1)=1.899189e+002; krok(n+1)=1.610269e-007; ng(n+1)=1.375401e-003;
n=83; farx(n+1)=1.705320e+001; foe(n+1)=1.899189e+002; krok(n+1)=1.314491e-009; ng(n+1)=1.375401e-003;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
